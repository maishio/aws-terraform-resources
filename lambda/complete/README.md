# AWS Lambda Terraform Resource

## Requirements

| Name      | Version  |
|-----------|----------|
| terraform | >= 1.3.0 |

## Providers

| Name | Version   |
|------|-----------|
| aws  | ~> 4.57.0 |

## Modules

No modules.

## Resources

| Name | Type |
|------|------|
| [aws_lambda_function.this](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/lambda_function) | resource |
| [aws_lambda_permission.this](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/lambda_permission) | resource |
| [aws_s3_bucket_notification.this](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_notification) | resource |

## Inputs

| Name | Description | Type | Default | Required |
|------|-------------|------|---------|:--------:|
| <a name="input_action"></a> [action](#input\_action) | AWS Lambda action you want to allow in this statement. Defaults to `lambda:InvokeFunction`. | `string` | `"lambda:InvokeFunction"` | no |
| <a name="input_bucket"></a> [bucket](#input\_bucket) | Name of the bucket for notification configuration. | `string` | `null` | no |
| <a name="input_create_s3_bucket_notification"></a> [create\_s3\_bucket\_notification](#input\_create\_s3\_bucket\_notification) | Whether to create an S3 bucket notification. Defaults to `false`. | `bool` | `false` | no |
| <a name="input_description"></a> [description](#input\_description) | Description of the Lambda function. | `string` | `null` | no |
| <a name="input_environments"></a> [environments](#input\_environments) | A list of environment objects for the dynamic block. | `any` | `[]` | no |
| <a name="input_filename"></a> [filename](#input\_filename) | The path to the function's deployment package within the local filesystem. | `string` | `null` | no |
| <a name="input_function_name"></a> [function\_name](#input\_function\_name) | Name of the function. | `string` | `null` | no |
| <a name="input_handler"></a> [handler](#input\_handler) | Function entrypoint in your code. | `string` | `null` | no |
| <a name="input_image_uri"></a> [image\_uri](#input\_image\_uri) | URI of a container image in the Amazon ECR registry. | `string` | `null` | no |
| <a name="input_layers"></a> [layers](#input\_layers) | A list of Lambda layer ARNs to attach to your Lambda function. | `list(string)` | `[]` | no |
| <a name="input_memory_size"></a> [memory\_size](#input\_memory\_size) | Amount of memory in MB your Lambda function can use at runtime. Defaults to `128`. | `number` | `128` | no |
| <a name="input_package_type"></a> [package\_type](#input\_package\_type) | The type of deployment package. Valid values are `Zip` and `Image`. Defaults to `Zip`. | `string` | `"Zip"` | no |
| <a name="input_principal"></a> [principal](#input\_principal) | Principal who is getting this permission. | `string` | `null` | no |
| <a name="input_role"></a> [role](#input\_role) | ARN of the function's execution role. | `string` | `null` | no |
| <a name="input_runtime"></a> [runtime](#input\_runtime) | Identifier of the function's runtime. | `string` | `null` | no |
| <a name="input_source_arn"></a> [source\_arn](#input\_source\_arn) | This parameter is used when allowing cross-account access, or for S3 and SES. | `string` | `null` | no |
| <a name="input_source_code_hash"></a> [source\_code\_hash](#input\_source\_code\_hash) | Base64-encoded representation of raw SHA-256 sum of the zip file. | `string` | `null` | no |
| <a name="input_statement_id"></a> [statement\_id](#input\_statement\_id) | A unique statement identifier. By default generated by Terraform. | `string` | `null` | no |
| <a name="input_tags"></a> [tags](#input\_tags) | A mapping of tags to assign to the resource. | `map(string)` | `{}` | no |
| <a name="input_timeout"></a> [timeout](#input\_timeout) | Amount of time your Lambda Function has to run in seconds. Defaults to `3`. | `number` | `3` | no |
| <a name="input_vpc_config"></a> [vpc\_config](#input\_vpc\_config) | A list of VPC configuration objects for the dynamic block. | `any` | `[]` | no |

## Outputs

| Name | Description |
|------|-------------|
| <a name="output_lambda_function"></a> [lambda\_function](#output\_lambda\_function) | n/a |

## Usage

```hcl

# Archive the function code

data "archive_file" "this" {
  type        = "zip"
  source_dir  = "./files/function/source/post_message"
  output_path = "./files/function/output/function.zip"
}

# Create a Lambda function

module "lambda" {
  source = "git::https://github.com/maishio/terraform-aws-resources.git//lambda/complete"

  # AWS Lambda

  filename         = data.archive_file.this.output_path
  function_name    = "${var.tags.service}-${var.tags.env}-post-message"
  handler          = "app.lambda_handler"
  layers           = var.layers
  memory_size      = 512
  role             = module.iam.iam_role.arn
  source_code_hash = data.archive_file.this.output_base64sha256
  runtime          = "python3.9"
  tags             = var.tags
  timeout          = 180
  environments = [
    {
      variables = {
        TEAMS_WEBHOOK_URL = var.teams_webhook_url
      }
    }
  ]

  # AWS Lambda Permission

  principal    = "logs.${var.region.id}.amazonaws.com"
  source_arn   = "arn:aws:logs:${var.region.id}:${var.account.id}:log-group:*:*"
}
```
